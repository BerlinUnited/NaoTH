/** Looking to the ball and than to the goal */
option goal_ball
{

  initial state search_for_ball
  {
    decision{
      if(ball.was_seen)
        goto hold_ball;
      else
        stay;
    }
    action
    {
      head.control_mode = search_for_ball;
      motion.type = stand;
    }
  }

  state search_for_goal
  {
    decision{
      if(goal.opp.time_since_seen == 0)
        goto hold_goal;
      else
        stay;
    }
    action
    {
      head.control_mode = search_for_goal;
      motion.type = stand;
    }
  }

  state hold_ball
  {
    decision{
      if (state_time>3000)
        goto turn_ball;
      else
        stay;

    }
    action
    {
      head.control_mode = search_for_ball;
      motion.type = stand;
      motion.walk_speed.x = 0; // mm
      motion.walk_speed.y = 0; // mm
      motion.walk_speed.rot = 0;
    }
  }

  state hold_goal
  {
    decision{
      if (state_time>3000)
        goto turn_goal;
      else
        stay;
    }
    action
    {
      head.control_mode = search_for_goal;
      motion.type = stand;
      motion.walk_speed.x = 0; // mm
      motion.walk_speed.y = 0; // mm
      motion.walk_speed.rot = 0;
    }
  }

    state turn_ball
  {
    decision{
      if (abs(value=ball.angle)<20)
        goto hold_ball2;
      else
        stay;

    }
    action
    {
      head.control_mode = search_for_ball;
      motion.type = walk;
      motion.walk_speed.x = 0; // mm
      motion.walk_speed.y = 0; // mm
      motion.walk_speed.rot = ball.angle;
    }
  }

  state turn_goal
  {
    decision{
      if (abs(value=goal.opp.angle) < 20)
        goto hold_goal2;
      else
        stay;
    }
    action
    {
      head.control_mode = search_for_goal;
      motion.type = walk;
      motion.walk_speed.x = 0; // mm
      motion.walk_speed.y = 0; // mm
      motion.walk_speed.rot = goal.opp.angle;
    }
  }

    state hold_ball2
  {
    decision{
      if (state_time>3000)
        goto search_for_goal;
      else
        stay;
    }
    action
    {
      head.control_mode = search_for_ball;
      motion.type = stand;
      motion.walk_speed.x = 0; // mm
      motion.walk_speed.y = 0; // mm
      motion.walk_speed.rot = 0;
    }
  }

  state hold_goal2
  {
    decision{
      if (state_time>3000)
        goto search_for_ball;
      else
        stay;
    }
    action
    {
      head.control_mode = search_for_goal;
      motion.type = stand;
      motion.walk_speed.x = 0; // mm
      motion.walk_speed.y = 0; // mm
      motion.walk_speed.rot = 0;
    }
  }
}
  